@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    /* Light theme - Enhanced with vibrant artistic touches */
    --background: 180 4% 99%; /* #fcfefd */
    --foreground: 243 84% 14%; /* #060541 */
    --card: 180 4% 99%;
    --card-foreground: 243 84% 14%;
    --popover: 180 4% 99%;
    --popover-foreground: 243 84% 14%;
    --primary: 243 84% 14%;
    --primary-foreground: 180 4% 99%;
    --secondary: 36 67% 81%; /* #e9ceb0 */
    --secondary-foreground: 243 84% 14%;
    --muted: 36 20% 92%;
    --muted-foreground: 243 10% 40%;
    --accent: 36 67% 81%;
    --accent-foreground: 243 84% 14%;
    --destructive: 0 84% 60%;
    --destructive-foreground: 210 40% 98%;
    --border: 220 13% 91%;
    --input: 214 32% 91%;
    --ring: 243 84% 14%;
    --radius: 0.75rem;

    /* Light mode vibrant artistic enhancements */
    --gradient-primary: linear-gradient(135deg, hsl(243 84% 14%) 0%, hsl(260 70% 25%) 50%, hsl(243 84% 18%) 100%);
    --gradient-secondary: linear-gradient(135deg, hsl(36 67% 81%) 0%, hsl(45 80% 75%) 50%, hsl(36 67% 85%) 100%);
    --gradient-card: linear-gradient(135deg, hsl(180 4% 99%) 0%, hsl(200 15% 96%) 30%, hsl(180 8% 97%) 100%);
    --gradient-background: linear-gradient(135deg, hsl(180 4% 99%) 0%, hsl(200 25% 95%) 50%, hsl(180 10% 98%) 100%);
    --gradient-nav: linear-gradient(135deg, hsl(180 4% 99%) 0%, hsl(210 30% 96%) 50%, hsl(220 20% 98%) 100%);
    --gradient-vibrant: linear-gradient(135deg, hsl(210 100% 88%) 0%, hsl(280 60% 88%) 50%, hsl(25 95% 88%) 100%);
    --gradient-warm: linear-gradient(135deg, hsl(25 95% 92%) 0%, hsl(45 80% 90%) 50%, hsl(60 70% 88%) 100%);
    --gradient-cool: linear-gradient(135deg, hsl(210 100% 92%) 0%, hsl(190 80% 90%) 50%, hsl(170 70% 88%) 100%);
    
    --accent-blue: 210 100% 75%;
    --accent-green: 142 76% 65%;
    --accent-orange: 25 95% 70%;
    --accent-purple: 280 60% 75%;
    --accent-pink: 320 70% 80%;
    --accent-cyan: 180 80% 70%;
    --accent-amber: 45 100% 70%;
    --accent-emerald: 160 75% 65%;
    
    --shadow-colored: 0 4px 20px hsla(243, 84%, 14%, 0.2), 0 2px 8px hsla(210, 100%, 75%, 0.15);
    --shadow-soft: 0 2px 12px hsla(220, 13%, 60%, 0.3), 0 1px 4px hsla(200, 20%, 70%, 0.2);
    --shadow-vibrant: 0 8px 32px hsla(210, 100%, 75%, 0.3), 0 4px 16px hsla(280, 60%, 75%, 0.2);
    --glow-primary: 0 0 30px hsla(243, 84%, 14%, 0.4), 0 0 60px hsla(210, 100%, 75%, 0.2);
    --glow-blue: 0 0 20px hsla(210, 100%, 75%, 0.6);
    --glow-green: 0 0 20px hsla(142, 76%, 65%, 0.6);
    --glow-orange: 0 0 20px hsla(25, 95%, 70%, 0.6);
    --glow-purple: 0 0 20px hsla(280, 60%, 75%, 0.6);
    /* Global layout offsets */
    --app-header-h: calc(56px + env(safe-area-inset-top));          /* Fixed header + iOS top safe area - made taller */
    --app-content-gap: 8px;        /* Extra breathing space for anchor scrolls */
    --app-bottom-tabs-h: 56px;     /* Mobile bottom tab bar height */
    
    /* Desktop/Tablet layout variables */
    --sidebar-width: 240px;
    --sidebar-mini-width: 70px;
    --desktop-header-h: 60px;
    --tablet-header-h: 56px;
    --tablet-sidebar-width: 180px;
    --tablet-sidebar-mini-width: 60px;
    --tablet-bottom-nav-h: 60px;
    
    /* Dynamic sidebar widths (updated by JavaScript) */
    --current-sidebar-width: 240px;
    --current-tablet-sidebar-width: 60px;
  }

  .dark {
    /* Dark theme - Enhanced with vibrant artistic touches */
    --background: 222 20% 6%; /* #0c0f14 */
    --foreground: 0 0% 95%;
    --card: 222 20% 6%;
    --card-foreground: 0 0% 95%;
    --popover: 222 20% 6%;
    --popover-foreground: 0 0% 95%;
    --primary: 0 0% 95%;
    --primary-foreground: 222 20% 6%;
    --secondary: 240 1% 38%; /* #606062 */
    --secondary-foreground: 0 0% 95%;
    --muted: 240 3% 30%;
    --muted-foreground: 240 5% 65%;
    --accent: 240 1% 52%; /* #858384 */
    --accent-foreground: 0 0% 95%;
    --destructive: 0 63% 31%;
    --destructive-foreground: 0 0% 95%;
    --border: 240 3% 30%;
    --input: 240 3% 25%;
    --ring: 240 4% 65%;

    /* Dark mode vibrant artistic enhancements */
    --gradient-primary: linear-gradient(135deg, hsl(0 0% 95%) 0%, hsl(210 30% 80%) 30%, hsl(260 40% 75%) 70%, hsl(210 20% 85%) 100%);
    --gradient-secondary: linear-gradient(135deg, hsl(240 1% 38%) 0%, hsl(260 15% 45%) 50%, hsl(240 5% 45%) 100%);
    --gradient-card: linear-gradient(135deg, hsl(222 20% 6%) 0%, hsl(235 25% 8%) 30%, hsl(250 20% 10%) 70%, hsl(222 25% 8%) 100%);
    --gradient-background: linear-gradient(135deg, hsl(222 20% 6%) 0%, hsl(235 25% 7%) 25%, hsl(250 20% 8%) 50%, hsl(260 15% 9%) 75%, hsl(235 20% 8%) 100%);
    --gradient-nav: linear-gradient(135deg, hsl(222 20% 6%) 0%, hsl(240 25% 12%) 50%, hsl(260 20% 15%) 100%);
    --gradient-vibrant: linear-gradient(135deg, hsl(210 100% 60%) 0%, hsl(280 70% 65%) 50%, hsl(25 95% 60%) 100%);
    --gradient-warm: linear-gradient(135deg, hsl(25 85% 55%) 0%, hsl(45 80% 60%) 50%, hsl(60 70% 65%) 100%);
    --gradient-cool: linear-gradient(135deg, hsl(210 100% 60%) 0%, hsl(190 80% 65%) 50%, hsl(170 70% 60%) 100%);
    
    --accent-blue: 210 100% 65%;
    --accent-green: 142 76% 55%;
    --accent-orange: 25 95% 60%;
    --accent-purple: 280 70% 65%;
    --accent-pink: 320 75% 70%;
    --accent-cyan: 180 85% 60%;
    --accent-amber: 45 100% 60%;
    --accent-emerald: 160 80% 55%;
    
    --shadow-colored: 0 4px 32px hsla(0, 0%, 0%, 0.7), 0 2px 16px hsla(210, 100%, 65%, 0.3);
    --shadow-soft: 0 2px 20px hsla(0, 0%, 0%, 0.5), 0 1px 8px hsla(240, 20%, 40%, 0.4);
    --shadow-vibrant: 0 8px 40px hsla(210, 100%, 65%, 0.4), 0 4px 20px hsla(280, 70%, 65%, 0.3);
    --glow-primary: 0 0 40px hsla(210, 100%, 65%, 0.5), 0 0 80px hsla(280, 70%, 65%, 0.3);
    --glow-blue: 0 0 25px hsla(210, 100%, 65%, 0.8);
    --glow-green: 0 0 25px hsla(142, 76%, 55%, 0.8);
    --glow-orange: 0 0 25px hsla(25, 95%, 60%, 0.8);
    --glow-purple: 0 0 25px hsla(280, 70%, 65%, 0.8);
  }
}

/* Ensure form field text is visible in all themes */
input, textarea, select {
  color: hsl(var(--foreground));
  caret-color: hsl(var(--foreground));
}

/* Placeholder contrast */
input::placeholder,
textarea::placeholder {
  color: hsl(var(--muted-foreground));
  opacity: 1; /* avoid extra dimming on some browsers */
}

/* Autofill in dark mode can force light text; normalize it */
.dark input:-webkit-autofill,
.dark textarea:-webkit-autofill,
.dark select:-webkit-autofill {
  -webkit-text-fill-color: hsl(var(--foreground)) !important;
  transition: background-color 100000s ease-in-out 0s; /* neutralize yellow autofill */
}

/* Mobile-specific styles with enhanced artistic touches - FIXED SCROLLING */
@layer base {
  * {
    @apply border-border;
  }
  
  html, body {
    @apply antialiased;
    background: var(--gradient-background);
    /* Use dynamic viewport units that work with mobile keyboards */
    min-height: 100dvh;
    height: 100dvh;
    overscroll-behavior-y: contain;
  }

  /* When keyboard is visible, use visual viewport height */
  body.keyboard-visible {
    height: var(--visual-viewport-height, 100vh);
    overflow: hidden;
  }
  
  body {
    @apply text-foreground;
    font-feature-settings: "rlig" 1, "calt" 1;
    background: var(--gradient-background);
  }

  #root {
    @apply min-h-screen;
    background: var(--gradient-background);
    /* Full width for all screen sizes, no mobile constraint */
    width: 100%;
    max-width: none;
    min-height: 100dvh;
    height: 100dvh;
  }

  body.keyboard-visible #root {
    height: var(--visual-viewport-height, 100vh);
  }
  
  /* Mobile-specific root styles only for mobile breakpoint */
  @media (max-width: 767px) {
    #root {
      @apply max-w-md mx-auto;
    }
  }

  /* App container with enhanced background */
  .app-container {
    @apply flex flex-col max-w-md w-full mx-auto;
    background: var(--gradient-background);
  }

  /* Mobile container with vibrant gradient - FIXED SCROLLING */
  .mobile-container {
    @apply max-w-md w-full mx-auto min-h-screen flex flex-col;
    background: var(--gradient-background);
    height: 100dvh;
    min-height: 100dvh;
  }

  body.keyboard-visible .mobile-container {
    height: var(--visual-viewport-height, 100vh);
  }

  /* Desktop container - full width layout */
  .desktop-container {
    @apply w-full min-h-screen;
    background: var(--gradient-background);
  }

  /* Tablet container - full width layout */
  .tablet-container {
    @apply w-full min-h-screen;
    background: var(--gradient-background);
  }

  /* Enhanced mobile buttons with vibrant gradients */
  .mobile-btn {
    @apply py-3 px-6 text-base rounded-xl font-medium transition-all active:scale-95;
    background: var(--gradient-primary);
    box-shadow: var(--shadow-colored);
    transition: all 0.3s ease;
  }

  .mobile-btn:hover {
    transform: translateY(-2px) scale(1.02);
    box-shadow: var(--glow-primary), var(--shadow-vibrant);
  }

  /* Enhanced mobile header with vibrant gradient */
  .mobile-header {
    @apply sticky top-0 z-10 flex items-center justify-between p-4 border-b;
    background: var(--gradient-nav);
    border-color: hsl(var(--border));
    box-shadow: var(--shadow-soft);
    backdrop-filter: blur(15px);
  }

  /* Mobile safe area (for bottom nav) */
  .safe-area-bottom {
    @apply pb-28;
  }

  /* Enhanced floating navigation with vibrant gradient and glow */
  .floating-nav {
    @apply fixed bottom-5 left-0 right-0 mx-auto max-w-sm z-10;
    @apply flex justify-around py-3 px-4 mx-4 rounded-full;
    background: var(--gradient-nav);
    backdrop-filter: blur(25px);
    border: 1px solid hsl(var(--border));
    box-shadow: var(--shadow-vibrant), var(--glow-primary);
  }

  /* Language specific */
  .rtl {
    direction: rtl;
    text-align: right;
  }
  
  /* Enhanced draggable widgets */
  .widget-draggable {
    touch-action: none;
    user-select: none;
    transition: all 0.3s ease;
  }

  .widget-draggable:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow-vibrant);
  }

  /* Enhanced widget styles */
  .calendar-widget {
    @apply rounded-lg border overflow-hidden;
    background: var(--gradient-card);
    border-color: hsl(var(--border));
    box-shadow: var(--shadow-soft);
  }
  
  .events-widget {
    @apply space-y-2;
  }
  
  .event-item {
    @apply flex items-center justify-between p-2 rounded-md transition-all duration-300;
    background: var(--gradient-card);
  }

  .event-item:hover {
    transform: translateX(4px);
    box-shadow: var(--shadow-soft);
  }

  /* Hide scrollbar but keep functionality */
  .scrollbar-hide {
    -ms-overflow-style: none;  /* Internet Explorer 10+ */
    scrollbar-width: none;  /* Firefox */
  }
  
  .scrollbar-hide::-webkit-scrollbar { 
    display: none;  /* Safari and Chrome */
  }

  /* Enhanced card styles with vibrant gradients */
  .enhanced-card {
    background: var(--gradient-card);
    border: 1px solid hsl(var(--border));
    box-shadow: var(--shadow-soft);
    transition: all 0.3s ease;
  }

  .enhanced-card:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow-vibrant);
  }

  /* Button enhancements */
  .btn-enhanced {
    background: var(--gradient-primary);
    box-shadow: var(--shadow-soft);
    transition: all 0.3s ease;
  }

  .btn-enhanced:hover {
    transform: translateY(-1px);
    box-shadow: var(--glow-primary), var(--shadow-vibrant);
  }

  .btn-secondary-enhanced {
    background: var(--gradient-secondary);
    box-shadow: var(--shadow-soft);
    transition: all 0.3s ease;
  }

  .btn-secondary-enhanced:hover {
    transform: translateY(-1px);
    box-shadow: var(--shadow-vibrant);
  }

  /* Form enhancements */
  .input-enhanced {
    background: var(--gradient-card);
    border: 1px solid hsl(var(--border));
    transition: all 0.3s ease;
    box-shadow: var(--shadow-soft);
  }

  .input-enhanced:focus {
    box-shadow: var(--glow-primary), var(--shadow-soft);
    border-color: hsl(var(--primary));
  }

  /* Status indicators with vibrant enhanced colors */
  .status-success {
    background: linear-gradient(135deg, hsl(var(--accent-green)) 0%, hsl(142 90% 70%) 50%, hsl(142 76% 88%) 100%);
    box-shadow: var(--glow-green);
  }

  .status-warning {
    background: linear-gradient(135deg, hsl(var(--accent-orange)) 0%, hsl(25 100% 75%) 50%, hsl(25 95% 88%) 100%);
    box-shadow: var(--glow-orange);
  }

  .status-info {
    background: linear-gradient(135deg, hsl(var(--accent-blue)) 0%, hsl(210 100% 80%) 50%, hsl(210 100% 88%) 100%);
    box-shadow: var(--glow-blue);
  }

  .status-error {
    background: linear-gradient(135deg, hsl(var(--destructive)) 0%, hsl(0 90% 65%) 50%, hsl(0 84% 55%) 100%);
  }

  /* Typography enhancements */
  .text-enhanced-heading {
    background: var(--gradient-primary);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    font-weight: 600;
  }

  .text-shadow-soft {
    text-shadow: 0 2px 4px hsla(0, 0%, 0%, 0.3);
  }

  /* Mobile Navigation Enhancement Classes */
  .nav-icon-calendar {
    color: hsl(var(--accent-blue));
    filter: drop-shadow(0 0 8px hsla(var(--accent-blue), 0.6));
  }

  .nav-icon-maw3d {
    color: hsl(var(--accent-purple));
    filter: drop-shadow(0 0 8px hsla(var(--accent-purple), 0.6));
  }

  .nav-icon-tr {
    color: hsl(var(--accent-green));
    filter: drop-shadow(0 0 8px hsla(var(--accent-green), 0.6));
  }

  .nav-icon-ai {
    color: hsl(var(--accent-orange));
    filter: drop-shadow(0 0 8px hsla(var(--accent-orange), 0.6));
  }

  .nav-icon-tasjeel {
    color: hsl(var(--accent-cyan));
    filter: drop-shadow(0 0 8px hsla(var(--accent-cyan), 0.6));
  }

  .nav-icon-active {
    animation: pulse-color 2s ease-in-out infinite;
    transform: scale(1.1);
  }

  /* Ensure anchor jumps and scrollIntoView land below the fixed header */
  html {
    scroll-padding-top: calc(var(--app-header-h) + var(--app-content-gap));
  }
  
  /* Desktop/Tablet scroll padding for floating headers */
  @media (min-width: 768px) {
    html {
      scroll-padding-top: 140px; /* Account for floating header height + spacing + extra buffer */
    }
  }

  /* Spacing is handled in AppLayout <main> via pt/pb using the variables above */

  /* Mobile keyboard support - proper viewport handling */
  /* App Layout adjustments */
  .app-layout-mobile {
    height: 100dvh;
    display: flex;
    flex-direction: column;
  }

  body.keyboard-visible .app-layout-mobile {
    height: var(--visual-viewport-height, 100vh);
  }

  /* Chat input positioning */
  .chat-input-container {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    z-index: 50;
    padding-bottom: env(safe-area-inset-bottom, 0px);
  }

  body.keyboard-visible .chat-input-container {
    position: fixed;
    bottom: 0;
    padding-bottom: 0;
    transform: translateY(0);
  }

  /* Mobile navigation adjustments */
  .mobile-nav {
    transition: transform 0.3s ease, opacity 0.3s ease;
  }

  body.keyboard-visible .mobile-nav {
    transform: translateY(100%);
    opacity: 0;
    pointer-events: none;
  }

  .chat-messages-container {
    flex: 1;
    overflow-y: auto;
    overflow-x: hidden;
    padding-bottom: calc(var(--app-bottom-tabs-h, 56px) + env(safe-area-inset-bottom, 0px) + 100px);
  }

  body.keyboard-visible .chat-messages-container {
    padding-bottom: calc(var(--chat-input-height, 80px) + 20px);
    max-height: calc(var(--visual-viewport-height, 100vh) - var(--app-header-h, 56px) - var(--chat-input-height, 80px));
  }

  /* Utility classes */
  .hide-on-keyboard {
    transition: opacity 0.3s ease, visibility 0.3s ease;
  }

  body.keyboard-visible .hide-on-keyboard {
    opacity: 0;
    visibility: hidden;
  }
}

/* PWA standalone adjustments: lock viewport height and disable overscroll bounce */
@media (display-mode: standalone) {
  html, body {
    height: 100svh;
    min-height: 100svh;
    overscroll-behavior: none;
    overscroll-behavior-y: none;
  }
  #root {
    min-height: 100svh;
  }
}

/* Improve iOS tap reliability and remove highlight */
.touch-manipulation {
  touch-action: manipulation;
  -webkit-tap-highlight-color: transparent;
}

/* iOS-specific: reduce heavy blur on fixed bars to avoid jank/freezes */
@supports (-webkit-touch-callout: none) {
  .ios-reduce-blur {
    -webkit-backdrop-filter: none !important;
    backdrop-filter: none !important;
  }
}

/* Super-glue fixed bars to the viewport on iOS */
.glue-fixed {
  position: fixed !important;
  transform: translateZ(0); /* create its own compositor layer */
  backface-visibility: hidden;
  will-change: transform;
  contain: layout style size; /* isolate layout calculations */
  /* iOS-specific: Force fixed positioning relative to initial viewport */
  -webkit-transform: translate3d(0, 0, 0);
  -webkit-backface-visibility: hidden;
  -webkit-perspective: 1000;
}

/* iOS Safari: Force header to stay at absolute top during keyboard */
@supports (-webkit-touch-callout: none) {
  .glue-top {
    position: fixed !important;
    top: env(safe-area-inset-top, 0px) !important;
    left: 0 !important;
    right: 0 !important;
    /* Force viewport-relative positioning */
    transform: translate3d(0, 0, 1000px) !important;
  }
  
  .glue-bottom {
    position: fixed !important;
    bottom: env(safe-area-inset-bottom, 0px) !important;
    left: 0 !important;
    right: 0 !important;
    /* Force viewport-relative positioning */
    transform: translate3d(0, 0, 1000px) !important;
  }
}

.glue-top {
  top: 0 !important;
  left: 0 !important;
  right: 0 !important;
}

.glue-bottom {
  bottom: 0 !important;
  left: 0 !important;
  right: 0 !important;
}

.glue-z {
  z-index: 2147480000 !important; /* extremely high to sit above any content */
}

/* Dark mode styles with enhanced vibrant visuals */
.dark #root {
  background: var(--gradient-background);
}

.dark .enhanced-card {
  background: var(--gradient-card);
  border-color: hsl(var(--border));
}

.dark .floating-nav {
  background: var(--gradient-nav);
  box-shadow: var(--shadow-vibrant), var(--glow-primary);
}

/* Light mode styles with enhanced vibrant visuals */
:root:not(.dark) #root {
  background: var(--gradient-background);
}

:root:not(.dark) .enhanced-card {
  background: var(--gradient-card);
  border-color: hsl(var(--border));
}

:root:not(.dark) .floating-nav {
  background: var(--gradient-nav);
  box-shadow: var(--shadow-soft), var(--glow-primary);
}

/* --- AI Image Loading Enhancements --- */
@layer components {
  /* Tiny indeterminate progress bar */
  .tiny-progress {
    position: relative;
    height: 3px;
    background: hsl(var(--border));
    border-radius: 9999px;
    overflow: hidden;
  }

  .tiny-progress::after {
    content: "";
    position: absolute;
    inset: 0 auto 0 -35%;
    width: 35%;
    background: linear-gradient(90deg, hsl(var(--accent-orange)) 0%, hsl(var(--accent-purple)) 100%);
    border-radius: inherit;
    animation: progress-run 1.15s ease-in-out infinite;
  }

  @keyframes progress-run {
    0% { transform: translateX(0%); }
    100% { transform: translateX(300%); }
  }

  /* Brush-like skeleton placeholder */
  .brush-skeleton {
    position: relative;
    background: linear-gradient(90deg, rgba(0,0,0,0.02) 0%, rgba(0,0,0,0.05) 50%, rgba(0,0,0,0.02) 100%);
    background-size: 200% 100%;
    animation: brush-sweep 1.6s ease-in-out infinite;
  }

  .brush-skeleton::after {
    content: "";
    position: absolute;
    inset: 0;
    pointer-events: none;
    background-image:
      repeating-linear-gradient( -10deg,
        rgba(255,255,255,0.0) 0px,
        rgba(255,255,255,0.0) 10px,
        rgba(255,255,255,0.12) 11px,
        rgba(255,255,255,0.12) 18px
      );
    mix-blend-mode: overlay;
  }

  @keyframes brush-sweep {
    0% { background-position: -100% 0; }
    100% { background-position: 200% 0; }
  }

  /* Blur-to-sharp reveal for final image */
  .img-blur-reveal {
    filter: blur(12px) brightness(1.1);
    animation: blur-reveal 650ms ease-out forwards;
  }

  @keyframes blur-reveal {
    0% { filter: blur(12px) brightness(1.1); }
    100% { filter: blur(0) brightness(1); }
  }

  /* Top-to-bottom wipe overlay during saving stage */
  .reveal-wipe {
    position: absolute;
    inset: 0;
    pointer-events: none;
    background: linear-gradient(180deg, rgba(255,255,255,0.85) 0%, rgba(255,255,255,0.35) 35%, rgba(255,255,255,0) 70%);
    mix-blend-mode: screen;
    animation: wipe-down 650ms ease-in-out forwards;
  }

  @keyframes wipe-down {
    0% { transform: translateY(-100%); opacity: 0.9; }
    100% { transform: translateY(100%); opacity: 0; }
  }
}

/* removed: forced visibility for #mobile-nav which interfered with keyboard-hide behavior */

/* DEV: shift nav up on desktop-pointer devices to avoid preview overlay bars */
@media (hover: hover) and (pointer: fine) {
  #mobile-nav.dev-shift-up {
    bottom: 80px !important;
  }
}

/* Hint the browser to use light-themed native controls in light mode */
:root {
  color-scheme: light;
}

/* Critically: enable dark-themed native form controls (select dropdown, date, etc.) */
.dark {
  color-scheme: dark;
}

/* Dark mode: force readable backgrounds and text for form fields */
.dark input:not([type="checkbox"]):not([type="radio"]),
.dark textarea,
.dark select {
  background-color: hsl(var(--card));
  color: hsl(var(--foreground));
  border-color: hsl(var(--border));
}

/* Dark mode: ensure native option/optgroup colors are readable */
.dark select option,
.dark select optgroup {
  background-color: hsl(var(--popover));
  color: hsl(var(--foreground));
}

/* iOS specific fixes */
@supports (-webkit-touch-callout: none) {
  html, body {
    position: fixed;
    overflow: hidden;
    width: 100%;
    height: 100dvh;
  }

  body.keyboard-visible {
    height: var(--visual-viewport-height, 100vh);
  }

  #root {
    position: relative;
    overflow: hidden;
    width: 100%;
    height: 100dvh;
  }

  body.keyboard-visible #root {
    height: var(--visual-viewport-height, 100vh);
  }
}
